{"ast":null,"code":"import{useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{deleteEmail,getEmails}from\"../redux/actions/subscriberAction\";import NotFound from\"../components/global/NotFound\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Subscription=function Subscription(){var _auth$user2,_auth$user4;var _useSelector=useSelector(function(state){return state;}),auth=_useSelector.auth,subscribers=_useSelector.subscribers;var dispatch=useDispatch();useEffect(function(){var _auth$user;if(((_auth$user=auth.user)===null||_auth$user===void 0?void 0:_auth$user.role)==='admin')dispatch(getEmails(auth.access_token));},[dispatch,(_auth$user2=auth.user)===null||_auth$user2===void 0?void 0:_auth$user2.role,auth.access_token]);var handleDelete=function handleDelete(id){var _auth$user3;if(((_auth$user3=auth.user)===null||_auth$user3===void 0?void 0:_auth$user3._id)!==id){if(window.confirm(\"Are you sure you want to delete this user?\")){dispatch(deleteEmail(id,auth.access_token));}}};if(((_auth$user4=auth.user)===null||_auth$user4===void 0?void 0:_auth$user4.role)!==\"admin\")return/*#__PURE__*/_jsx(NotFound,{});return/*#__PURE__*/_jsx(\"div\",{className:\"w-100 my-5 d-flex justify-content-center overflow-auto\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"table\",{className:\"table neomorphism\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"_id\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"CreatedAt\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"text-secondary\",children:subscribers.map(function(data){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"row\",children:data._id}),/*#__PURE__*/_jsx(\"td\",{children:data.email}),/*#__PURE__*/_jsx(\"td\",{children:new Date(data.createdAt).toDateString()}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:/*#__PURE__*/_jsx(\"i\",{style:{cursor:'pointer'},className:\"fas fa-trash-alt text-danger\",title:\"Remove\",onClick:function onClick(){return handleDelete(data._id);}})})]},data._id);})})]})})});};export default Subscription;","map":{"version":3,"sources":["/home/kushal/tip-saza/client/src/pages/subscription.tsx"],"names":["useEffect","useDispatch","useSelector","deleteEmail","getEmails","NotFound","Subscription","state","auth","subscribers","dispatch","user","role","access_token","handleDelete","id","_id","window","confirm","map","data","email","Date","createdAt","toDateString","cursor"],"mappings":"AAAA,OAASA,SAAT,KAA0B,OAA1B,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,OAASC,WAAT,CAAsBC,SAAtB,KAAuC,mCAAvC,CAEA,MAAOC,CAAAA,QAAP,KAAqB,+BAArB,C,wFAGA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,6BAEvB,iBAA6BJ,WAAW,CAAC,SAACK,KAAD,QAAsBA,CAAAA,KAAtB,EAAD,CAAxC,CAAQC,IAAR,cAAQA,IAAR,CAAaC,WAAb,cAAaA,WAAb,CAEA,GAAMC,CAAAA,QAAQ,CAAGT,WAAW,EAA5B,CAEAD,SAAS,CAAC,UAAM,gBACZ,GAAG,aAAAQ,IAAI,CAACG,IAAL,gDAAWC,IAAX,IAAoB,OAAvB,CAAgCF,QAAQ,CAACN,SAAS,CAACI,IAAI,CAACK,YAAN,CAAV,CAAR,CACnC,CAFQ,CAEP,CAACH,QAAD,cAAUF,IAAI,CAACG,IAAf,sCAAU,YAAWC,IAArB,CAA0BJ,IAAI,CAACK,YAA/B,CAFO,CAAT,CAIA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,EAAD,CAAe,iBAChC,GAAG,cAAAP,IAAI,CAACG,IAAL,kDAAWK,GAAX,IAAmBD,EAAtB,CAA0B,CACtB,GAAGE,MAAM,CAACC,OAAP,CAAe,4CAAf,CAAH,CAAgE,CAC7DR,QAAQ,CAACP,WAAW,CAACY,EAAD,CAAIP,IAAI,CAACK,YAAT,CAAZ,CAAR,CACF,CACJ,CACJ,CAND,CAQA,GAAG,cAAAL,IAAI,CAACG,IAAL,kDAAWC,IAAX,IAAoB,OAAvB,CAAgC,mBAAO,KAAC,QAAD,IAAP,CAChC,mBACI,YAAK,SAAS,CAAC,wDAAf,uBACI,kCACI,eAAO,SAAS,CAAC,mBAAjB,wBACI,oCACI,mCACI,WAAI,KAAK,CAAC,KAAV,iBADJ,cAEI,WAAI,KAAK,CAAC,KAAV,mBAFJ,cAGI,WAAI,KAAK,CAAC,KAAV,uBAHJ,cAII,WAAI,KAAK,CAAC,KAAV,oBAJJ,GADJ,EADJ,cASI,cAAO,SAAS,CAAC,gBAAjB,UAEOH,WAAW,CAACU,GAAZ,CAAgB,SAAAC,IAAI,qBACnB,mCACI,WAAI,KAAK,CAAC,KAAV,UAAiBA,IAAI,CAACJ,GAAtB,EADJ,cAEI,oBAAKI,IAAI,CAACC,KAAV,EAFJ,cAGI,oBAAK,GAAIC,CAAAA,IAAJ,CAASF,IAAI,CAACG,SAAd,EAAyBC,YAAzB,EAAL,EAHJ,cAII,WAAI,SAAS,CAAC,aAAd,uBACI,UAAG,KAAK,CAAE,CAACC,MAAM,CAAC,SAAR,CAAV,CAA8B,SAAS,CAAC,8BAAxC,CAAuE,KAAK,CAAC,QAA7E,CACI,OAAO,CAAE,yBAAMX,CAAAA,YAAY,CAACM,IAAI,CAACJ,GAAN,CAAlB,EADb,EADJ,EAJJ,GAASI,IAAI,CAACJ,GAAd,CADmB,EAApB,CAFP,EATJ,GADJ,EADJ,EADJ,CA+BH,CAlDD,CAoDA,cAAeV,CAAAA,YAAf","sourcesContent":["import { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { deleteEmail, getEmails } from \"../redux/actions/subscriberAction\";\nimport { RootStore } from \"../utils/TypeScript\";\nimport NotFound from \"../components/global/NotFound\";\n\n\nconst Subscription = () => {\n\n    const { auth,subscribers } = useSelector((state: RootStore) => state)\n    \n    const dispatch = useDispatch()\n\n    useEffect(() => {\n        if(auth.user?.role === 'admin') dispatch(getEmails(auth.access_token!))\n    },[dispatch,auth.user?.role,auth.access_token])\n\n    const handleDelete = (id:string) => {\n        if(auth.user?._id !== id) {\n            if(window.confirm(\"Are you sure you want to delete this user?\")){\n               dispatch(deleteEmail(id,auth.access_token!))\n            }\n        }\n    }\n\n    if(auth.user?.role !== \"admin\") return <NotFound/>\n    return (\n        <div className=\"w-100 my-5 d-flex justify-content-center overflow-auto\">\n            <div>\n                <table className=\"table neomorphism\">\n                    <thead>\n                        <tr>\n                            <th scope=\"col\">_id</th>\n                            <th scope=\"col\">Email</th>\n                            <th scope=\"col\">CreatedAt</th>\n                            <th scope=\"col\">Action</th>\n                        </tr>\n                    </thead>\n                    <tbody className=\"text-secondary\">\n                       {\n                           subscribers.map(data => (\n                            <tr key={data._id} >\n                                <th scope=\"row\">{data._id}</th>\n                                <td>{data.email}</td>\n                                <td>{new Date(data.createdAt).toDateString()}</td>\n                                <td className=\"text-center\">\n                                    <i style={{cursor:'pointer'}} className=\"fas fa-trash-alt text-danger\" title=\"Remove\"\n                                        onClick={() => handleDelete(data._id)} ></i>\n                                </td>\n                            </tr>\n                           ))\n                       }\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    )\n}\n\nexport default Subscription;"]},"metadata":{},"sourceType":"module"}