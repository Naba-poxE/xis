{"ast":null,"code":"import _regeneratorRuntime from\"/home/kushal/tip-saza/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/kushal/tip-saza/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useCallback,useEffect,useRef}from'react';import{useDispatch}from'react-redux';import ReactQuill from'react-quill';import'react-quill/dist/quill.snow.css';import{ALERT}from'../../redux/types/alertType';import{checkImage,imageUpload}from'../../utils/ImageUpload';import{jsx as _jsx}from\"react/jsx-runtime\";var Quill=function Quill(_ref){var setBody=_ref.setBody,body=_ref.body;var quillRef=useRef(null);var dispatch=useDispatch();var modules={toolbar:{container:container}};//Custom image\nvar handleChangeImage=useCallback(function(){var input=document.createElement('input');input.type='file';input.accept='image/*';input.click();input.onchange=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _quill$getEditor$getS;var files,file,check,photo,quill,range;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:files=input.files;if(files){_context.next=3;break;}return _context.abrupt(\"return\",dispatch({type:ALERT,payload:{errors:\"File does not exist\"}}));case 3:file=files[0];check=checkImage(file);if(!check){_context.next=7;break;}return _context.abrupt(\"return\",dispatch({type:ALERT,payload:{errors:check}}));case 7:dispatch({type:ALERT,payload:{loading:true}});_context.next=10;return imageUpload(file);case 10:photo=_context.sent;quill=quillRef.current;range=quill===null||quill===void 0?void 0:(_quill$getEditor$getS=quill.getEditor().getSelection())===null||_quill$getEditor$getS===void 0?void 0:_quill$getEditor$getS.index;if(range!==undefined){quill===null||quill===void 0?void 0:quill.getEditor().insertEmbed(range,'image',\"\".concat(photo.url));}dispatch({type:ALERT,payload:{loading:false}});case 15:case\"end\":return _context.stop();}}},_callee);}));},[dispatch]);useEffect(function(){var quill=quillRef.current;if(!quill)return;var toolbar=quill.getEditor().getModule('toolbar');toolbar.addHandler('image',handleChangeImage);},[handleChangeImage]);return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(ReactQuill,{theme:\"snow\",modules:modules,placeholder:\"Write something...\",onChange:function onChange(e){return setBody(e);},value:body,ref:quillRef})});};var container=[[{'font':[]}],[{'header':[1,2,3,4,5,6,false]}],[{'size':['small',false,'large','huge']}],// custom dropdown\n['bold','italic','underline','strike'],// toggled buttons\n['blockquote','code-block'],[{'color':[]},{'background':[]}],// dropdown with defaults from theme\n[{'script':'sub'},{'script':'super'}],// superscript/subscript\n[{'list':'ordered'},{'list':'bullet'}],[{'indent':'-1'},{'indent':'+1'}],// outdent/indent\n[{'direction':'rtl'}],// text direction\n[{'align':[]}],['clean','link','image','video']];export default Quill;","map":{"version":3,"sources":["/home/kushal/tip-saza/client/src/components/editor/ReactQuill.tsx"],"names":["React","useCallback","useEffect","useRef","useDispatch","ReactQuill","ALERT","checkImage","imageUpload","Quill","setBody","body","quillRef","dispatch","modules","toolbar","container","handleChangeImage","input","document","createElement","type","accept","click","onchange","files","payload","errors","file","check","loading","photo","quill","current","range","getEditor","getSelection","index","undefined","insertEmbed","url","getModule","addHandler","e"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useRef } from 'react';\nimport { useDispatch } from 'react-redux';\nimport ReactQuill from 'react-quill';\nimport 'react-quill/dist/quill.snow.css';\nimport { ALERT } from '../../redux/types/alertType';\nimport { checkImage, imageUpload } from '../../utils/ImageUpload';\n\n\n\ninterface IProps {\n    setBody: (value: string) => void\n    body: string\n}\n\nconst Quill: React.FC<IProps> = ({ setBody,body }) => {\n    const quillRef = useRef<ReactQuill>(null)\n\n    const dispatch = useDispatch()\n\n    const modules = { toolbar: { container }}\n\n    //Custom image\n\n    const handleChangeImage = useCallback(() => {\n        const input = document.createElement('input')\n        input.type = 'file'\n        input.accept = 'image/*'\n        input.click()\n\n        input.onchange = async () => {\n            const files = input.files\n            if(!files) return dispatch({\n                type: ALERT,\n                payload: { errors: \"File does not exist\"}\n            });\n\n            const file = files[0]\n            const check = checkImage(file)\n            if(check) return dispatch({\n                type: ALERT,\n                payload: { errors: check }\n            });\n            \n            dispatch({type: ALERT, payload: { loading: true }})\n            const photo = await imageUpload(file)\n            const quill = quillRef.current;\n            const range = quill?.getEditor().getSelection()?.index\n\n            if(range !== undefined) {\n                quill?.getEditor().insertEmbed(range,'image',`${photo.url}`)\n            }\n\n            dispatch({type: ALERT, payload: { loading: false }})\n        }\n    },[dispatch])\n\n    useEffect(() => {\n        const quill = quillRef.current;\n        if(!quill) return;\n\n        let toolbar = quill.getEditor().getModule('toolbar')\n        toolbar.addHandler('image', handleChangeImage)\n    },[handleChangeImage])\n\n    return (\n        <div>\n            <ReactQuill \n                theme=\"snow\" \n                modules={modules} \n                placeholder=\"Write something...\" \n                onChange={(e) => setBody(e)}\n                value={body}\n                ref={quillRef} />\n        </div>\n    )\n}\n\nlet container = [\n    [{ 'font': [] }],\n    [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\n    [{ 'size': ['small', false, 'large', 'huge'] }],  // custom dropdown\n  \n    ['bold', 'italic', 'underline', 'strike'],        // toggled buttons\n    ['blockquote', 'code-block'],\n    [{ 'color': [] }, { 'background': [] }],          // dropdown with defaults from theme\n    [{ 'script': 'sub'}, { 'script': 'super' }],      // superscript/subscript\n  \n    [{ 'list': 'ordered'}, { 'list': 'bullet' }],\n    [{ 'indent': '-1'}, { 'indent': '+1' }],          // outdent/indent\n    [{ 'direction': 'rtl' }],                         // text direction\n    [{ 'align': [] }],\n  \n    ['clean', 'link', 'image','video']\n  ]\n\n\nexport default Quill;"]},"metadata":{},"sourceType":"module"}